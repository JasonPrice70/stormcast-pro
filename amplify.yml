version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "=== AMPLIFY BUILD DIAGNOSTICS ==="
        - node --version
        - npm --version
        - echo "Current directory contents:"
        - ls -la
        - echo "Installing dependencies..."
        - npm ci --silent
        - echo "=== DEPENDENCIES INSTALLED ==="
    build:
      commands:
        - echo "=== STARTING BUILD ==="
        - echo "Building React app with Vite (TypeScript handled by Vite)..."
        - npm run build:amplify
        - echo "=== BUILD COMPLETED ==="
        - echo "Checking build output..."
        - ls -la dist/ || echo "No dist folder found"
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
